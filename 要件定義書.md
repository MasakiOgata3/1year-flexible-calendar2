# 1年単位変形労働時間制カレンダー作成Webアプリケーション 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
1年単位変形労働時間制カレンダー作成Webアプリケーション

### 1.2 目的
労働基準法第32条の4に基づく1年単位変形労働時間制を導入する企業が、法定要件を満たした年間カレンダーをWeb上で作成できるツールを提供する。

### 1.3 対象ユーザー
- 人事労務担当者
- 社会保険労務士
- 経営者
- 労務管理システム管理者

### 1.4 開発背景
既存のExcelベースのカレンダー作成ツールをWeb化し、より使いやすく、アクセシブルなツールとして提供する。

## 2. 機能要件

### 2.1 基本設定機能
#### 2.1.1 起算日設定
- **機能概要**: 変形労働時間制の起算日を設定
- **入力形式**: 日付選択（カレンダーUI）
- **バリデーション**: 
  - 必須入力
  - 有効な日付形式
  - 過去1年〜未来2年の範囲内

#### 2.1.2 所定労働時間設定
- **機能概要**: 1日の基本所定労働時間を設定
- **入力形式**: 数値入力（時間：分）
- **バリデーション**:
  - 必須入力
  - 0.5〜12時間の範囲内
  - 0.5時間単位での入力

#### 2.1.3 週開始曜日設定
- **機能概要**: カレンダー表示の週開始曜日を設定
- **入力形式**: ドロップダウン選択
- **選択肢**: 日曜日、月曜日
- **デフォルト値**: 日曜日

### 2.2 休日設定機能
#### 2.2.1 週休日パターン設定
- **機能概要**: 第1週〜第5週の休日パターンを個別設定
- **設定項目**:
  - 各週の休日曜日選択（複数選択可）
  - 週ごとの所定労働時間設定
- **入力方式**: チェックボックス + 時間入力

#### 2.2.2 祝日設定
- **機能概要**: 祝日の扱いを設定
- **設定項目**:
  - 祝日を休日とするか
  - 祝日の労働時間設定
- **祝日データ**: 内閣府祝日APIまたは静的データを使用

### 2.3 カレンダー生成機能
#### 2.3.1 年間カレンダー作成
- **機能概要**: 設定に基づき1年間のカレンダーを自動生成
- **表示形式**: 月ごとの表形式
- **表示情報**:
  - 各日の労働時間
  - 休日表示
  - 祝日表示
  - 週労働時間合計
  - 月労働時間合計

#### 2.3.2 個別日調整機能
- **機能概要**: 生成後のカレンダーで個別の日を調整
- **調整可能項目**:
  - 労働時間の変更
  - 休日/労働日の切り替え
  - 特別な労働時間の設定
- **入力方式**: インライン編集

### 2.4 法定要件チェック機能
#### 2.4.1 労働基準法チェック
- **チェック項目**:
  - 年間総労働時間上限（2,085時間）の確認
  - 連続労働日数の確認（6日以内）
  - 1日の労働時間上限（10時間）の確認
  - 1週間の労働時間上限（52時間）の確認
- **表示方式**: チェック結果一覧、エラー箇所のハイライト

#### 2.4.2 警告・エラー表示
- **警告レベル**:
  - エラー: 法定要件違反（赤色表示）
  - 警告: 推奨基準超過（黄色表示）
  - 情報: 参考情報（青色表示）

### 2.5 出力機能
#### 2.5.1 PDF出力
- **出力内容**:
  - 年間カレンダー（月別）
  - 設定情報
  - 法定要件チェック結果
- **レイアウト**: A4サイズ、印刷対応

#### 2.5.2 Excel出力
- **出力形式**: 元のExcelファイルと同等の形式
- **内容**: 全設定データとカレンダーデータ

#### 2.5.3 CSV出力
- **出力内容**: 日別労働時間データ
- **用途**: 他システムとの連携

### 2.6 データ管理機能
#### 2.6.1 設定保存
- **保存場所**: ローカルストレージ
- **保存項目**: 基本設定、休日パターン、個別調整データ
- **自動保存**: 設定変更時に自動保存

#### 2.6.2 設定読み込み
- **機能概要**: 保存済み設定の読み込み
- **複数設定管理**: 設定名を付けて複数パターンを管理

## 3. 非機能要件

### 3.1 性能要件
- **レスポンス時間**: 各操作2秒以内
- **カレンダー生成時間**: 5秒以内
- **同時利用者数**: 100ユーザー（将来拡張時）

### 3.2 ユーザビリティ要件
- **対応ブラウザ**: Chrome, Firefox, Safari, Edge（最新版）
- **レスポンシブ対応**: PC, タブレット対応
- **アクセシビリティ**: WCAG 2.1 AA準拠

### 3.3 セキュリティ要件
- **データ保護**: 個人情報の適切な取り扱い
- **入力バリデーション**: XSS, SQLインジェクション対策
- **通信暗号化**: HTTPS必須

### 3.4 保守性要件
- **コード品質**: TypeScript使用、ESLint/Prettier適用
- **テスト**: 単体テスト、統合テストの実装
- **ドキュメント**: 開発・運用ドキュメントの整備

## 4. 技術要件

### 4.1 フロントエンド
- **フレームワーク**: React 18+
- **言語**: TypeScript
- **状態管理**: Zustand または Context API
- **スタイリング**: Tailwind CSS
- **UI コンポーネント**: Headless UI または Radix UI
- **フォーム管理**: React Hook Form
- **日付処理**: date-fns
- **バリデーション**: Zod

### 4.2 バックエンド（必要に応じて）
- **ランタイム**: Node.js 18+
- **フレームワーク**: Express.js
- **データベース**: 不要（フロントエンドのみで完結）

### 4.3 ビルド・デプロイ
- **バンドラー**: Vite
- **ホスティング**: Vercel または Netlify
- **CI/CD**: GitHub Actions

### 4.4 開発環境
- **パッケージマネージャー**: npm または yarn
- **コード品質**: ESLint, Prettier
- **テスト**: Jest, React Testing Library
- **型チェック**: TypeScript strict mode

## 5. 画面構成

### 5.1 メイン画面
- **ヘッダー**: タイトル、ナビゲーション
- **サイドバー**: 設定パネル
- **メインエリア**: カレンダー表示エリア
- **フッター**: 操作ボタン、ステータス表示

### 5.2 設定パネル
- **基本設定タブ**: 起算日、労働時間、週開始曜日
- **休日設定タブ**: 週休パターン、祝日設定
- **詳細設定タブ**: その他オプション

### 5.3 カレンダー表示エリア
- **月別タブ**: 各月のタブ
- **週表示**: 週単位での詳細表示
- **統計表示**: 労働時間統計

## 6. データ仕様

### 6.1 設定データ構造
```typescript
interface CalendarSettings {
  startDate: Date;
  dailyWorkHours: number;
  weekStartDay: 'sunday' | 'monday';
  weeklyPatterns: WeeklyPattern[];
  holidaySettings: HolidaySettings;
  customAdjustments: DateAdjustment[];
}

interface WeeklyPattern {
  weekNumber: 1 | 2 | 3 | 4 | 5;
  restDays: DayOfWeek[];
  workHours: number;
}

interface DateAdjustment {
  date: Date;
  workHours: number;
  isWorkDay: boolean;
}
```

### 6.2 カレンダーデータ構造
```typescript
interface CalendarData {
  year: number;
  months: MonthData[];
  totalWorkHours: number;
  totalWorkDays: number;
}

interface MonthData {
  month: number;
  days: DayData[];
  monthlyWorkHours: number;
  monthlyWorkDays: number;
}

interface DayData {
  date: Date;
  workHours: number;
  isWorkDay: boolean;
  isHoliday: boolean;
  dayType: 'work' | 'rest' | 'holiday';
}
```

## 7. 開発フェーズ

### フェーズ1: 基本機能実装
- 基本設定UI
- カレンダー生成機能
- 基本的な表示機能

### フェーズ2: 高度な機能実装
- 休日設定機能
- 個別調整機能
- 法定要件チェック

### フェーズ3: 出力・保存機能
- PDF/Excel出力
- 設定保存・読み込み
- データ管理機能

### フェーズ4: 品質向上・最適化
- テスト実装
- パフォーマンス最適化
- アクセシビリティ対応

## 8. 制約事項

### 8.1 法的制約
- 労働基準法第32条の4に準拠
- 地域による労働法の違いは考慮しない（日本国内のみ対応）

### 8.2 技術的制約
- インターネット接続必須（祝日データ取得のため）
- モダンブラウザのみ対応
- JavaScript無効環境は非対応

### 8.3 運用制約
- 個人情報の収集・保存は行わない
- ユーザー認証機能は実装しない
- データの永続化はローカルストレージのみ

## 9. リスクと対策

### 9.1 技術的リスク
- **ブラウザ互換性**: 対応ブラウザの明確化、Polyfill使用
- **パフォーマンス**: 大量データ処理の最適化
- **データ損失**: 自動保存機能の実装

### 9.2 法的リスク
- **法改正対応**: 法改正情報の定期確認、アップデート機能
- **計算間違い**: 十分なテストの実施、検証機能の充実

### 9.3 ユーザビリティリスク
- **操作の複雑さ**: ステップバイステップのUI設計
- **エラー処理**: 明確なエラーメッセージとガイダンス

## 10. 成功指標

### 10.1 品質指標
- バグ発生率: 0.1%未満
- ユーザビリティテスト: 満足度80%以上
- パフォーマンス: Core Web Vitals良好

### 10.2 機能指標
- 法定要件チェック精度: 100%
- カレンダー生成成功率: 99%以上
- 出力機能成功率: 95%以上

---

**作成日**: 2025年6月27日  
**最終更新**: 2025年6月27日  
**バージョン**: 1.0  
**作成者**: Claude Code Assistant